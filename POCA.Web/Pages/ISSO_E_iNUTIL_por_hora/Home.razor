@page "/"
@inject UserSessionService UserSession
@inject NavigationManager NavigationManager

<PageTitle>Home</PageTitle>

@if (UserSession.IsLoggedIn)
{
    @if (UserSession.CurrentUser.IsProfessor)
    {
        <MudText>Você já está logado como professor</MudText>
    }
    else
    {
        <MudText>Você já está logado como aluno</MudText>

    }
}
else
{
    <MudText>Você já não está logado</MudText>
    <MudButton Variant="Variant.Filled" Color="Color.Primary" Class="mt-4" OnClick="NavigateLogin">Logar</MudButton>
}

@code
{
    protected override void OnInitialized()
    {
        UserSession.OnChange += HandleUserSessionChanged;
    }

    private void HandleUserSessionChanged()
    {
        InvokeAsync(StateHasChanged);
    }   

    public void Dispose()
    {
        UserSession.OnChange -= HandleUserSessionChanged;
    }
    
    public void NavigateLogin()
    {
        NavigationManager.NavigateTo("/login");
    }
}